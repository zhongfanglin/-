"use strict";var shopCar={init:function(){this.lis=document.querySelector(".shopList .lis"),this.lists=document.querySelector(".com"),this.liAll=this.lists.querySelectorAll("li"),this.but=this.lists.querySelectorAll("button"),this.shopUser=document.querySelector(".shopUser"),this.getData(),this.event(),this.carData(),this.checkAll()},event:function(){for(var e=this,n=this,t=function(t){e.but[t].onclick=function(){n.setItem(n.data[t]),n.lis.innerHTML="",n.carData(),n.checkAll()}},i=0;i<this.but.length;i++)t(i);localStorage.username?this.shopUser.innerHTML="".concat(localStorage.username,"，请登录"):this.shopUser.innerHTML="您好，请登录"},getData:function(){var e=this;sendAjax("json/shopcar.json").then(function(t){t=JSON.parse(t),e.data=t,e.insertData(t)})},insertData:function(t){for(var e=0;e<this.liAll.length;e++)this.liAll[e].querySelector("img").src=t[e].src,this.liAll[e].querySelector(".con").innerHTML=t[e].contents,this.liAll[e].querySelector(".pri").innerHTML=t[e].price},setItem:function(t){var e=localStorage.getItem("shopList")||"[]";e=JSON.parse(e);for(var n=0;n<e.length;n++)if(e[n].name==t.name){e[n].num=parseInt(e[n].num)+parseInt(t.num);break}n==e.length&&e.push(t),localStorage.shopList=JSON.stringify(e)},carData:function(){this.lis.innerHTML="","[]"!=localStorage.shopList?document.querySelector(".shopList p").style.display="block":((n=document.createElement("li")).innerHTML="购物车空，<a href='index1.html'>去购物吧</a>",n.style.fontSize="24px",n.style.textAlign="center",n.style.lineHeight="150px",this.lis.appendChild(n),document.querySelector(".shopList p").style.display="none");var t=localStorage.shopList||"[]";t=JSON.parse(t);for(var e=0;e<t.length;e++){var n,i=parseInt(t[e].price)*parseInt(t[e].num);(n=document.createElement("li")).innerHTML='<div class="contentsAll clearfix">\n\t\t\t\t\t\t\t<div class="inp"><input type="checkbox" class=\'checkboxs\' /></div>\n\t\t\t\t\t\t\t<div class="img">\n\t\t\t\t\t\t\t\t<img src="'.concat(t[e].src,'" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="con">').concat(t[e].contents,'</div>\n\t\t\t\t\t\t\t<div class="colors">\n\t\t\t\t\t\t\t\t<p class="co">颜色：').concat(t[e].color,'</p>\n\t\t\t\t\t\t\t\t<p class="si">尺寸：').concat(t[e].size,'</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="price">').concat(t[e].price,'</div>\n\t\t\t\t\t\t\t<div class="num"><input type="number" value=\'').concat(t[e].num,'\' /></div>\n\t\t\t\t\t\t\t<div class="jiage">\n\t\t\t\t\t\t\t\t<span>').concat(i,".00</span>\n\t\t\t\t\t\t\t\t<i>").concat(t[e].weight,'</i>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="move">\n\t\t\t\t\t\t\t<p class=\'rm\'>删除</p>\n\t\t\t\t\t\t\t<p>移到我的关注</p>\n\t\t\t\t\t\t\t<p>加到我的关注</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="dazhe">预约中，抢购开始时间2018-12-12 00:00</div>\n\t\t\t\t\t'),this.lis.appendChild(n)}},checkAll:function(){for(var i=this,t=document.querySelectorAll(".rm"),e=0;e<t.length;e++)t[e].index=e;this.lis.onclick=function(t){var e=(t=t||window.event).target||t.srcElement;if("删除"==e.innerHTML){var n=localStorage.shopList;(n=JSON.parse(n)).splice(e.index,1),localStorage.shopList=JSON.stringify(n),i.carData()}};var n=document.querySelector(".all"),s=document.querySelectorAll(".checkboxs");n.onclick=function(){for(var t=0;t<s.length;t++)n.checked,s[t].checked=n.checked};for(var c=0;c<s.length;c++)s[c].onclick=function(){for(var t=0;t<s.length&&s[t].checked;t++);t==s.length?n.checked=!0:n.checked=!1};var l=document.querySelectorAll(".jiage span");localStorage.sum=l.length;var r=document.querySelector(".heji span"),a=0;for(e=0;e<l.length;e++)a+=parseInt(l[e].innerHTML);r.innerHTML=a+".00"}};shopCar.init();